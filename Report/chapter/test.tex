\chapter{Test}
\label{chp:test}

Testing is an important part of a project. It is used to check the behavior of the source code, and to make sure that the functionality is correct. The initially creation time is high, but in the end it saves time and cost in the development process because errors are easier and earlier discovered.

In this project testing is divided into two parts. One part is the test of the drawing engine in Scheme. The other part is test of the WPF application in C\#.

\section{Scheme test}
The test of the drawing engine in scheme  is implemented i the test.ss file. For each function i Scheme.ss, \emph{line, rectangle, circle, fill, bounding-box, text-at} and \emph{draw} a test is made. To test functions in scheme.ss from test.ss the scheme.ss file is loaded into the test file. A function in scheme is tested by comparing the output of a function to the expected value of the output. To do this, \emph{equal?} is used. This is shown in listing \ref{equal}.

\begin{lstlisting}[caption={Comparison of actual output with the expected output with equal?}, label=equal]
(and (equal? (candidate 0 0 8 8) '(0 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8)))
\end{lstlisting}

This example is taken from the \emph{test-line} function. The line function takes 4 parameters, \emph{x, y, x2} and \emph{y2}. The test feeds the parameters 0, 0, 8 and 8, and compares the result to see if it is equal to what is expected. The expected value is in this example '0 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8' which is a line from the point (0,0) to (8,8). When the test function is written a TestRun function to run the test is made. Listing \ref{testrun} shows the run af a function along with it's test function. 

\begin{lstlisting}[caption={TestRunLine}, label=testrun]
(define TestRunLine (test-line line))
\end{lstlisting}

\emph{test-line} is the test function and \emph{line} is the function that needs to be tested. When \emph{TestRunLine} is executed it will return a \#t for true or a \#f for false.

\section{C\# Unit Testing}
The C\# WPF application has been tested by using xUnit.net and ReSharper xunit test runner. The tests are structured by \emph{Arrange, Act} and \emph{Assert}. The tests are placed in a separate test project called GraphikosTests. Every method is tested for all the successful and unsuccessful scenarios.

In some tests a mock is needed which the framework Moq is used to do. The mocks are used to separate the different classes. The mocks are effective to separate the individual classes which results in unit tests and not integration tests.

The maintenance of the code is made lesser error prone with the unit tests. This could result in a faster development time.

To be able to test the bitmaps which are generated or changed by different classes. The bitmaps are converted to a byte array and compared with another byte array which they should match. If they don’t match the bitmaps the functions are generating is wrong. This testing method was chosen because bitmaps don’t have any relevant properties to test on.